<!DOCTYPE html>
<html>
<head>
	<script src="/js/jquery.min.js"></script>
	<script>
	
	var commands = [];
	var sort = ["command","response"];
	
	$(document).ready(function() {
		loadData();
	});
	
	function loadData() {
		$.post("/cgi-bin/commandList.cgi","",dataHandler,"json");
	}
	
	function dataHandler(msg,status,xhr) {
		commands = msg.commands;
		display();
	}
	
	function changeSort(type) {
		if (type == "response") {
			sort = ["response","command"];
		} else {
			sort = ["command","response"];
		}
		display();
	}
	
	function display() {
		commands.sort(function(a,b) {
			if (a[sort[0]] == b[sort[0]]) {
				if (a[sort[1]] > b[sort[1]]) {
					return 1;
				} else if (a[sort[1]] < b[sort[1]]) {
					return -1;
				} else {
					return 0;
				}
				return a[sort[1]] - b[sort[1]];
			}
			if (a[sort[0]] > b[sort[0]]) {
				return 1;
			} else if (a[sort[0]] < b[sort[0]]) {
				return -1;
			} else {
				return 0;
			}
		});
		table = document.getElementById("commands");
		
		table.innerHTML = "<tr><th onclick='changeSort(\"command\");'>Command</th><th onclick='changeSort(\"response\");'>Response</th><th>Cooldown</th></tr>";
		
		for (i = 0; i < commands.length; i++) {
			var tr = document.createElement("tr");
			
			var td = document.createElement("td");
			td.innerHTML = commands[i].command;
			tr.appendChild(td);
			
			td = document.createElement("td");
			td.innerHTML = commands[i].response;
			tr.appendChild(td);
			
			td = document.createElement("td");
			td.innerHTML = commands[i].cooldown;
			tr.appendChild(td);
			
			table.appendChild(tr);
		}
	}
	
	</script>
	<style type="text/css">
	
	#commands {
		width: 100%;
	}
	
	table, tr, td, th {
		border: 1px solid black;
		vertical-align: top;
	}
	
	#commands tr td:first-child {
		max-width: 30%;
		word-break: break-all;
	}
	
	#commands tr:nth-child(even) {
		background-color: #e7eaec;
	}
	
	</style>
</head>
<body>

<table id="commands">
</table>

</body>
</html>